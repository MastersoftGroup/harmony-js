"use strict";angular.module("harmonyHosted.service",[]).provider("HRAService",function(){function a(a,d,e,f){var g,h=this;this.getFullAddress=function(h,i,j){var k=j||b.authToken,l=d.defer(),m=(i?i.toUpperCase():void 0)||"AU";if(e.cancel(g),k&&0!=k.trim().length){if(!(h.length<b.minimumInputLength)){var n=btoa(k),o=b.serviceURL+m.toLowerCase()+"/address?callback=JSON_CALLBACK&fullAddress="+h+"&Authorization=Basic+"+n+"&sourceOfTruth="+c[m];return g=e(function(){f.debug("Sending a request back to the Restful service ...")},b.waitMillis,1),g.then(function(){return a.jsonp(o)})}l.reject({data:{status:"INSUFFICIENT_REQUEST"}})}else l.reject({data:{status:"AUTH_REQUIRED"}});return f.debug("HRA fast-failed response!"),l.promise},this.getAddress=function(a,b){var c=["AU","NZ"];return b&&c.indexOf(b.toUpperCase())!=-1?h.getFullAddress(a,b).then(function(a){var b=[];return angular.forEach(a.data.payload,function(a){b.push(a.fullAddress)}),b}):[]}}var b={serviceURL:"/harmony/rest/",minimumInputLength:5,waitMillis:300},c={AU:"AUPAF",NZ:"NZPAF"};this.setParams=function(a){for(var c in a){var d=a[c];b[c]=d}},this.$get=function(b,c,d,e){return new a(b,c,d,e)}});